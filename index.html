<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Generador de Logo - Daniel Gómez</title>
  <link rel="icon" type="image/jpeg" href="img/logo_daniel.jpg">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&display=swap" rel="stylesheet">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:Montserrat,Arial,sans-serif;
      background:#2AA9E1;
      color:#fff;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      min-height:100vh;
      padding:2rem 1rem 4rem;
      text-align:center;
    }
    h1{font-size:1.4rem;font-weight:800;margin-bottom:0.3rem;}
    p.lead{font-size:0.9rem;color:#d7eaff;margin-bottom:1.5rem;}
    .controls{display:flex;flex-wrap:wrap;justify-content:center;gap:0.5rem;margin-bottom:1.5rem;}
    input[type="text"]{padding:0.6rem 0.8rem;border-radius:8px;border:1px solid #cfe6fb;font-size:1rem;width:200px;max-width:90vw;transition:box-shadow .2s;}
    input[type="text"]:focus{outline:none;box-shadow:0 0 0 3px #9fd7f8;}
    button{padding:0.6rem 1rem;border-radius:8px;border:none;cursor:pointer;font-weight:800;transition:background .2s,transform .2s;background:#fff;color:#2AA9E1;}
    button:hover{transform:scale(1.03);background:#e8f3ff;}

    .preview-wrap{width:100%;display:flex;justify-content:center;}
    .preview{width:min(90vw,650px);aspect-ratio:1/1;border-radius:8px;position:relative;overflow:hidden;box-shadow:0 0 25px rgba(0,0,0,0.2);display:flex;align-items:center;justify-content:center;background:#2AA9E1;}

    .preview img.bg{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;z-index:0;}

    .logo-area{text-align:center;width:95%;transform-origin:center;position:relative;z-index:1;opacity:1;transition:transform 0.3s ease,opacity 0.3s ease;}
    .logo-area.typing{transform:scale(1.02);opacity:0.9;}
    .logo-area.finished{transform:scale(1);opacity:1;animation:pop 0.4s ease;}

    @keyframes pop{0%{transform:scale(0.95);}50%{transform:scale(1.05);}100%{transform:scale(1);}}

    .line-top,.line-bottom{font-weight:900;text-transform:uppercase;white-space:nowrap;display:block;overflow:visible;word-spacing:0.15em;}
    .line-top{color:#fff;}
    .line-bottom{color:#000;margin-top:-0.1em;}
    .char{display:inline-block;position:relative;}
    .rayito{width:0.8em;height:auto;vertical-align:middle;transform:translateY(-0.05em);object-fit:contain;}

    .note{margin-top:1rem;color:#cfe6fb;font-size:0.8rem;}
    footer{margin-top:2rem;font-size:0.85rem;color:#d8ecfa;text-align:center;}
    footer a{color:#fff;text-decoration:none;font-weight:700;}footer a:hover{text-decoration:underline;}
  </style>
</head>
<body>
  <h1>Generador de logo — Daniel Gómez ⚡</h1>
  <p class="lead">Escribe tu nombre y apellido; la <strong>i</strong> se transformará en el rayo.</p>

  <div class="controls">
    <input id="firstNameInput" type="text" placeholder="Nombre ej: Camilo" maxlength="12" pattern="^[^\s]+$" title="No se permiten espacios ni más de 12 caracteres">
    <input id="lastNameInput" type="text" placeholder="Apellido ej: Vélez" maxlength="12" pattern="^[^\s]+$" title="No se permiten espacios ni más de 12 caracteres">
    <button id="downloadBtn">Descargar</button>
  </div>

  <div class="preview-wrap">
    <div class="preview" id="preview">
      <img src="img/fondo.jpg" alt="Fondo" class="bg" onerror="this.style.display='none'">
      <div class="logo-area" id="logoArea">
        <div id="lineTop" class="line-top"></div>
        <div id="lineBottom" class="line-bottom"></div>
      </div>
    </div>
  </div>

  <p class="note">Genera tu logo y descárgalo automáticamente en formato JPG.</p>

  <footer>© 2025 • Creado por <a href="https://www.instagram.com/camilovelezrod" target="_blank" rel="noopener noreferrer">Camilo Vélez</a></footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    const firstNameInput = document.getElementById('firstNameInput');
    const lastNameInput = document.getElementById('lastNameInput');
    const downloadBtn = document.getElementById('downloadBtn');
    const lineTop = document.getElementById('lineTop');
    const lineBottom = document.getElementById('lineBottom');
    const logoArea = document.getElementById('logoArea');
    const raySrc = 'img/rayito.png';

    function escapeHtml(s){return String(s).replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));}

    function tokenizeWithSingleRay(fullNameUpper){
      const chars = Array.from(fullNameUpper);
      const tokens = [];
      let usedRay=false;
      for(let ch of chars){
        if(!usedRay && ch==='I'){tokens.push({type:'ray'});usedRay=true;}
        else tokens.push({type:'char',value:ch});
      }
      if(!usedRay)tokens.push({type:'ray'});
      return tokens;
    }

    function tokensToHtml(tokens){
      return tokens.map(t=>t.type==='ray'?`<span class="char"><img class="rayito" src="${raySrc}" alt="⚡"></span>`:`<span class="char">${escapeHtml(t.value)}</span>`).join('');
    }

    function autoFit(){
      const maxWidth=logoArea.clientWidth*0.95;
      let fontSize=400;const minSize=100;
      lineTop.style.fontSize=fontSize+'px';lineBottom.style.fontSize=fontSize+'px';
      while((logoArea.scrollWidth>maxWidth)&&fontSize>minSize){
        fontSize-=10;
        lineTop.style.fontSize=fontSize+'px';
        lineBottom.style.fontSize=fontSize+'px';
      }
    }

    function renderName(first,last){
      const full=`${first} ${last}`.trim();
      if(!full)return;
      const upperFull=full.toUpperCase();
      const tokens=tokenizeWithSingleRay(upperFull);
      const firstLen=Array.from(first.toUpperCase()).length;
      const topTokens=tokens.slice(0,firstLen);
      const bottomTokens=tokens.slice(firstLen);
      if(last){lineTop.innerHTML=tokensToHtml(topTokens);lineBottom.innerHTML=tokensToHtml(bottomTokens);}else{lineTop.innerHTML=tokensToHtml(tokens);lineBottom.innerHTML='';}
      logoArea.classList.add('typing');
      setTimeout(()=>logoArea.classList.remove('typing'),500);
      autoFit();
    }

    downloadBtn.addEventListener('click',async()=>{
      const first=firstNameInput.value.trim();
      const last=lastNameInput.value.trim();
      if(!first)return alert('Escribe tu nombre ⚡');
      renderName(first,last);
      logoArea.classList.add('finished');
      await new Promise(r=>setTimeout(r,400));
      logoArea.classList.remove('finished');
      const node=document.getElementById('preview');
      try{
        const canvas=await html2canvas(node,{useCORS:true,scale:4});
        const imgData=canvas.toDataURL('image/jpeg',1.0);
        const link=document.createElement('a');
        const safeName=`${first}_${last}`.replace(/\s+/g,'_');
        link.download=`logo_${safeName}.jpg`;
        link.href=imgData;
        link.click();
      }catch(err){
        console.error(err);
        alert('Error al generar la descarga. Prueba en un servidor local.');
      }
    });

    [firstNameInput,lastNameInput].forEach(i=>i.addEventListener('input',()=>{
      i.value=i.value.replace(/\s/g,'').slice(0,12);
      renderName(firstNameInput.value,lastNameInput.value);
    }));

    renderName(firstNameInput.value,lastNameInput.value);
  </script>
</body>
</html>